# Проектная работа "Веб-ларек"

## Оглавление

- [Описание проекта](#описание-проекта)
- [Установка и запуск](#установка-и-запуск)
- [Сборка](#сборка) -[Архитектура проекта](#архитектура-проекта)
- [Слой Model](#слой-model)
- [Слой View](#слой-view)
- [Слой Presenter](#слой-presenter)
- [Ключевые типы данных](#ключевые-типы-данных)
- [Размещение в сети](#размещение-в-сети)

## Описание проекта

Проект "Веб-ларек" реализует пример интернет-магазина с товарами для веб-разработчиков. Пользователь может просматривать каталог товаров, выбирать и добавить товары в корзину, так же оформить заказ.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта

В проекте применен принцип MVP (Model-View-Presenter), который обеспечивает четкое разделение ответственностей между классами Model и View каждый класс выполняет свою определенную роль:

- Model - работает с данными, проводит вычисления и руководит всеми бизнес-процессами. получение, обновление и удаление данных;
- View - показывает пользователю интерфейс и данные из модели. Отображение данных, обработка нажатий кнопок, заполнения/отправка форма, а также их валидация;
- Presenter - служит прослойкой между моделью и видом. Обработчик событий;

## Слой Model

### Класс Model

Абстрактный класс, который используется для создания объекта хранения данных.

Методы:

- `emitChanges()` - Уведомляет о изменении модели;

### Класс AppData

Класс отвечает за состояние данных приложения. Класс наследуется от абстрактного класса Model.

Методы:

- `setProduct()` - Установить внутри класса данные о продуктах;
- `setPreviewProduct()` - Установить значение в классе и иницировать событие изменения данных;
- `getProduct()` — Получить данные о продуктах;
- `addToBasket()` — Добавить данные продуктов в корзине;
- `removeFromBasket()` — Удалить данные продуктов в корзине;
- `getTotal()` — Получить общую сумму стоимость товаров в корзине;
- `clearBasket()` - Очистить корзину;
- `setOrder()` - Установить значения полей для формирования заказа;
- `getOrder()` - Получить заполенную форму заказа;
- `validateOrder()` - Проверить корректность заполнения формы;

## Слой View

### Класс Component

Абстрактный класс обеспечивает работу с DOM. Его функции - устанавливать данные в компонентах и отображать их.

Методы класса:

- `setText()` - Установить текстовое содержимое;
- `setImage()` - Установить изображение;
- `setVisible()` - Показать компонент;
- `setHidden()` - Скрыть компонент;
- `setDesibled()` - Сменить статус блокировки;
- `toggleClass()` - Переключить класс;
- `render()` - Метод рендеринга элемента;

### Класс Modal

Наследуется от абстрактного класса Component. Реализует модальное окно. Предоставляет методы для управления состоянием окна и генерации событий.

Методы:

- `setContent()` — Установить контент внутри модального окна;
- `open()` — Открыть модальное окно;
- `close()` — Закрыть модальное окно;
- `render()` — Метод рендеринга элемента;

### Класс Form

Общий класс для работы с формами. Наследуется от класса Component. Отвечает за установку ошибок при заполнении формы, блокировку кнопки сабмита, если форма не валидна, и отрисовку самой формы.

Класс является дженериком и принимает в переменной T тип и состав данных, какие мы хотим получить на вход.

Методы:

- `setErrors()` — Установить ошибки при отсутствии заполненных полей;
- `validateForm()` — Проверить корректность заполнения формы;
- `render()` — Метод рендеринга элемента;

### Класс Page

Компонент для отображения и изменения контента страницы.

Методы:

- `setCounter()` - Установить значений счетчика продуктов в корзине;
- `setCatalog()` - Установить каталог продуктов;
- `setLocked()` - Блокировка\разблокировка страницы;

### Класс Product

Реализует карточку товара (используется на главной, в модальном окне и в корзине).

Методы:

- `setTitle()` - Установить заголовок карточки;
- `setImage()` - Установить изображение карточки;
- `setDescription()` - Установить описание карточки;
- `setButtonText()` - Установить текст кнопки;
- `getPrice()` - Получить цену товара;
- `setPrice()` - Установить цену товара;
- `setCategory()` - Установить категорию товара и добавляет соответствующий класс;

### Класс Basket

Отвечает за отображение товаров в корзине и общей суммы заказа. При клике на кнопку формируется соответствующее событие об открытии формы заказа.

Методы:

- `toggleButton()` - Активировать/деактивировать кнопку оформления заказа;
- `setProducts()` - Отобразить карточки товаров в корзине;
- `setTotal()` - Установить общую стоимость товаров;

### Класс BasketProduct

Отвечает за отображение карточки товара в магазине.

Методы:

- `setTitle()` - Установить название товара;
- `setPrice()` - Установить цену товара;
- `setIndex()` - Установить номер товара в корзине;

### Класс OrderAddress

Наследуется от класса Form. Форма оплаты и доставки.

Методы:

- `setButtonPayment()` - Установить сособ оплаты;
- `setAddress()` - Установить значение поля адреса;

### Класс OrderContacts

Наследуется от класса Form. Форма контактной информации.

Методы:

- `setPhone()` - Установить значение поля телефона;
- `setEmail()` - Установить значение поля email;

### Класс Success

Реализует окно с подтверждением заказа. Отображает общую сумму заказа. При клике на кнопку закрывается модальное окно:

- `setTotal()` - Установить значение общей суммы заказа;

## Слой Presenter

### Класс Api

Класс содержит логику отправки запросов.

Свойства класса:

- `readonly baseUrl: string` - Неизменяемое свойство, базового URL;
- `protected options: RequestInit` - Защищенное свойство, дополнительные параметры для HTTP-запросов;

Конструктор принимает следующие аргументы:

- `this.baseUrl = baseUrl` - Базовый URL
- `this.options = {}` - Дополнительные параметры для HTTP-запросов

Класс имеет такие методы:

- `protected handleResponse(response: Response): Promise<object> {}` - Защищеный метод, обрабатывающий полученный ответ от сервера. Если ответ положительный, он возвращает содержимое ответа в виде JSON. В противном случае, он формирует ошибку;
- `get(uri: string) {}` - Получить данные с сервера;
- `post(uri: string, data: object, method: ApiPostMethods = 'POST') {}` - Отправить данные на сервер

## Класс EventEmitter

Реализует паттерн "Наблюдатель" и позволяет подписываться на события и уведомлять подписчиков о наступлении события.

Класс имеет методы:

- `on<T extends object>(eventName: EventName, callback: (event: T) => void) {}` - Установить обработчик на событие;
- `off(eventName: EventName, callback: Subscriber) {}` - Снять обработчик с события;
- `emit<T extends object>(eventName: string, data?: T) {}` - Инициировать событие с данными;
- `onAll(callback: (event: EmitterEvent) => void) {}` - Слушать все события;
- `offAll() {}` - Сбросить все обработчики;
- `trigger<T extends object>(eventName: string, context?: Partial<T>) {}` - Сделать коллбек триггер, генерирующий событие при вызове;

### Класс AppWebShop

Дополняет базовый класс API методами работы с конкретным сервером проекта:

- `getProductList()` - Получить массив продуктов с сервера;
- `getIdProduct()` - Получить продукт с сервера по переданному id;
- `postOrder()` - Отправить переданный заказ на сервер и возвратить результат;

## Ключевые типы данных

```TypeScript
// интерфейс, описывающий карточку товара в магазине
interface IProduct {
	id: string; // уникальный ID
	title: string; // наименование товара
	description: string; // описание товара
	image: string; // ссылка на картинку товара
	category: string; // категория на товар
	price: string; // цена товара
}

// интерфейс, описывающий данные способа оплаты и адреса доставки
interface OrderAddress {
	payment: TPayment; // выбор метода оплаты товара
	address: string; // адрес доставки
}

// интерфейс, описывающий данные контактов
interface OrderContact {
	email: string; // адрес электорнной почты
	phone: string; // номер телефона
}

// интерфейс, описывающий все поля заказа
interface OrderForm extends OrderAddress, OrderContact {}

// интерфейс для описания данных заказа
interface Order extends OrderForm {
	products: IProduct[]; // массив ID купленных товаров
	total: string; // сумма заказа
}

// интерфейс, описывающий результат заказа
interface OrderResult {
	id: string;
	total: string;
}

// интерфейс для реализации API клиента
interface IProductAPI {
	getProductList: () => Promise<IProduct[]>; // получить список покупок
	getProductById: (id: string) => Promise<IProduct>; // получить сведений о товаре по ID
	orderProduct: (order: Order) => Promise<OrderResult[]>; // покупка товара
}

// тип описывающий все возможные способы оплаты
type TPayment = 'online' | 'offline';
```

## Размещение в сети

- Репозиторий проекта: https://github.com/LeaTrixWizzer/web-larek-frontend.git